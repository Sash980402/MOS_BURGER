<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MOS Burgers - Menu</title>
  <link rel="stylesheet" href="assets/css/style.css">
  <link href="https://fonts.googleapis.com/css?family=Poppins:400,600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>
  <header>
    <div class="logo"><strong>MOS Burgers</strong></div>
    <span id="current-user" style="color:#457b9d;font-weight:600;margin-left:1.5rem;"></span>
    <button class="hamburger" aria-label="Open navigation" aria-controls="main-nav" aria-expanded="false"><i class="fa fa-bars"></i></button>
    <nav id="main-nav" aria-label="Main navigation">
      <a href="index.html">Home</a>
      <a href="menu.html" class="active">Menu</a>
      <a href="cart.html">Cart</a>
      <a href="customers.html">Customers</a>
      <a href="reports.html">Reports</a>
      <a href="login.html" id="login-link">Login</a>
      <a href="#" id="logout-link" style="display:none;">Logout</a>
      <a href="user-logins.html" id="user-logins-link" style="display:none;">User Login Report</a>
      <a href="register.html" id="register-user-link" style="display:none;">Register User</a>
    </nav>
  </header>
  <div class="container">
    <h1>Menu</h1>
    <button class="button" id="add-menu-btn" style="margin-bottom:1.5rem;display:none;"><i class="fa fa-plus"></i> Add New Item</button>
    <div id="menu-search-container" style="margin-bottom:1.5rem;">
      <input type="text" id="menu-search" placeholder="Search menu items..." style="width:100%;padding:0.7rem 1rem;border-radius:8px;border:1px solid #ccc;font-size:1rem;">
    </div>
    <div id="menu-category-tabs" style="display:flex;gap:1rem;margin-bottom:1.5rem;flex-wrap:wrap;"></div>
    <div id="menu-list" class="menu-grid">
    </div>
    <div id="cart-layout" style="display:grid;grid-template-columns:2.2fr 1fr;gap:2.5rem;align-items:flex-start;margin-top:0;">
      <div id="cart-items-column" style="margin:0;"></div>
      <div id="order-summary-column">
        <div id="order-summary"></div>
      </div>
    </div>
    <button id="floating-cart-btn" style="display:none;position:fixed;bottom:24px;right:24px;z-index:1200;background:#e63946;color:#fff;border:none;border-radius:50%;width:60px;height:60px;box-shadow:0 4px 16px rgba(230,57,70,0.18);font-size:2rem;align-items:center;justify-content:center;">
      <span style="position:relative;"><i class="fa fa-shopping-cart"></i><span id="cart-count-badge" style="position:absolute;top:-10px;right:-10px;background:#fff;color:#e63946;border-radius:50%;font-size:0.9rem;padding:2px 7px;font-weight:700;">0</span></span>
    </button>
    <div id="cart-modal-overlay" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(30,33,44,0.45);z-index:1199;"></div>
    <div id="cart-modal" style="display:none;position:fixed;bottom:0;left:0;width:100vw;max-height:80vh;background:#fff;border-radius:18px 18px 0 0;box-shadow:0 -4px 24px rgba(69,123,157,0.13);z-index:1201;overflow-y:auto;transition:transform 0.25s;transform:translateY(100%);">
      <div style="padding:1.5rem 1.2rem 1.2rem 1.2rem;position:relative;">
        <button id="close-cart-modal" style="position:absolute;top:12px;right:18px;background:none;border:none;color:#e63946;font-size:1.7rem;cursor:pointer;opacity:0.8;z-index:1;">&times;</button>
        <div id="cart-modal-content"></div>
      </div>
    </div>
  </div>
  <script src="assets/js/main.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const hamburger = document.querySelector('.hamburger');
      const nav = document.getElementById('main-nav');
      hamburger.addEventListener('click', () => {
        nav.classList.toggle('open');
        document.body.classList.toggle('nav-open');
        hamburger.setAttribute('aria-expanded', nav.classList.contains('open'));
      });
      window.addEventListener('resize', () => {
        if(window.innerWidth > 700) {
          nav.classList.remove('open');
          document.body.classList.remove('nav-open');
          hamburger.setAttribute('aria-expanded', 'false');
        }
      });
      document.addEventListener('keydown', e => {
        if(e.key === 'Escape') {
          nav.classList.remove('open');
          document.body.classList.remove('nav-open');
          hamburger.setAttribute('aria-expanded', 'false');
        }
      });

      function updateAuthLinks() {
        const isLoggedIn = localStorage.getItem('loggedInUser');
        document.getElementById('login-link').style.display = isLoggedIn ? 'none' : '';
        document.getElementById('logout-link').style.display = isLoggedIn ? '' : 'none';
        const userSpan = document.getElementById('current-user');
        if (userSpan) {
          userSpan.textContent = isLoggedIn ? `Logged in as: ${isLoggedIn}` : '';
        }
        const regLink = document.getElementById('register-user-link');
        if (regLink) {
          regLink.style.display = isLoggedIn === 'admin' ? '' : 'none';
        }
        const loginsLink = document.getElementById('user-logins-link');
        if (loginsLink) {
          loginsLink.style.display = isLoggedIn === 'admin' ? '' : 'none';
        }
      }

      document.getElementById('logout-link').onclick = function() {

        const username = localStorage.getItem('loggedInUser');
        if (username) {
          let logs = JSON.parse(localStorage.getItem('userLogs') || '[]');
          const lastLog = logs.find(log => log.username === username && !log.logout);
          if (lastLog) {
            lastLog.logout = new Date().toISOString();
            localStorage.setItem('userLogs', JSON.stringify(logs));
          }
        }
        localStorage.removeItem('loggedInUser');
        updateAuthLinks();
        location.reload();
      };

      updateAuthLinks();
      const addBtn = document.getElementById('add-menu-btn');
      if (localStorage.getItem('loggedInUser') === 'admin') {
        addBtn.style.display = '';
        addBtn.onclick = function() { showAddMenuItemModal(this); };
      } else {
        addBtn.style.display = 'none';
      }

      const searchInput = document.getElementById('menu-search');
      if (searchInput) {
        searchInput.addEventListener('input', function() {
          const searchTerm = this.value.toLowerCase();
          const activeCategory = document.querySelector('.menu-tab.active')?.dataset.cat || '';
          renderMenu(searchTerm, activeCategory);
        });
      }

      renderMenu();
    });
  </script>
</body>
</html> 